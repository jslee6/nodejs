<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="/main.css" rel="stylesheet">
</head>

<body class="grey-bg">
    <%- include('nav.ejs') %>     
    
    <!-- html 처럼 나오려면 - 로표기 = 는 문자나 숫자처럼 나옴 -->
    

    <div class="white-bg">
      <% for (let i = 0; i < 글목록.length; i++){ %>
        <div class="list-box">
          <h4>
            <a href="/detail/<%= 글목록[i]._id %>">
              <%= 글목록[i].title %>
            </a>
            <a href="/edit/<%= 글목록[i]._id %>">✏️</a>
            <span class="delete" data-id="<%= 글목록[i]._id %>">🗑️</span>  
            <!-- data-id="<%= 글목록[i]._id %> 는 삭제 버튼을 데이타 id에 넣음 47번째로 연결-->
          </h4>
          <p><%= 글목록[i].content %></p>
        </div>
      <% } %>
    </div>

    <!-- <script>
      document.querySelectorAll('.delete')[0].addEventListener('click', function(){
        fetch('/abc', {
          method : 'POST',
          headers : { 
            'Content-Type' : 'application/json' 
          },
          body : JSON.stringify({a : 1})
        })
      })
    </script> AJAX 1 내역  -->

<script>

  document.querySelectorAll('.delete')[0].addEventListener('click', function(e){
    fetch('/delete?docid=' + e.target.dataset.id, {
    method : 'DELETE'
  })
  
  .then((r)=>r.text())
    .then((r)=>console.log(r))
})     //  쿼리스트링 ?  ajx ? 위에 +기호는 문자 두개 합쳐주세요 ,  e.target.dataset.id== 문자라서 +로 합치고 위에 data-id 에서 받은 데이타셋에 id를 넣음


// document.querySelectorAll('.delete')[1].addEventListener('click', function(e){
//     fetch('/delete?docid=' + e.target.dataset.id, {
//     method : 'DELETE'
//   })
// })  

// document.querySelectorAll('.delete')[2].addEventListener('click', function(e){
//     fetch('/delete?docid=' + e.target.dataset.id, {
//     method : 'DELETE'
//   })
// })  

</script> 



   <!-- 폼태그 말고 ajax 를 사용할수잇음. 이게 ajax. get , post ,delete ,put 등 중요!!! /abc 하여서 server.js 에서-->
  

  </body>
</html>